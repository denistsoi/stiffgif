var Vue=require("vue"),ipc=require("electron").ipcRenderer,clipboard=require("electron").clipboard;Vue.directive("img",function(e){var n=new Image;n.src=e,n.onload=function(){this.el.src=e,this.el.className="active"}.bind(this)});var app=new Vue({el:"#app",data:{searchInput:"",selection:"",giphy:[],popkey:[],scope:"trending",loading:!1,popkeyIsDone:!1,giphyIsDone:!1,online:!1},methods:{copyToClipboard:function(e){var n=e.target.src.toString();this.$set("selection",n),clipboard.writeText(n)},search:function(e){var n=e.target.value.toString().trim()||this.$data.searchInput;self.giphy?self.giphy.length:0;n&&(this.$set("scope","search"),this.$set("giphyIsDone",!0),this.$set("popkeyIsDone",!0),ipc.send("search",n))},fetch:function(e){var n=this;n.loading||(n.loading=!0,"search"===n.scope?(ipc.send("fetch:giphy",{scope:n.scope,query:n.searchInput,offset:n.giphy.length}),ipc.send("fetch:popkey",{scope:n.scope,query:n.searchInput,offset:n.giphy.length})):"trending"===n.scope&&(ipc.send("fetch:giphy",{scope:n.scope,offset:n.giphy.length}),ipc.send("fetch:popkey",{scope:n.scope,offset:n.giphy.length})))}},ready:function(){var e=this;document.querySelector("input").focus(),e.fetch(),window.addEventListener("scroll",function(n){var t=500,i=document.body.scrollTop+window.innerHeight+t;document.body.scrollHeight<i&&setTimeout(e.fetch(),2e3)})}}),updateOnlineStatus=function(){ipc.send("online-status-changed",navigator.onLine?"online":"offline")};window.addEventListener("online",updateOnlineStatus),window.addEventListener("offline",updateOnlineStatus),updateOnlineStatus(),ipc.on("online",function(e,n){n?app.$set("online",!0):app.$set("online",!1)}),ipc.on("search:giphy",function(e,n){var t=JSON.parse(n).data;app.$set("giphy",t)}),ipc.on("search:popkey",function(e,n){var t=JSON.parse(n);app.$set("popkey",t)}),ipc.on("fetched:giphy",function(e,n){var t=JSON.parse(n).data;return t.length?(t.forEach(function(e){app.$data.giphy.push(e)}),void app.$set("loading",!1)):void app.$set("giphyIsDone",!0)}),ipc.on("fetched:popkey",function(e,n){var t=JSON.parse(n);return t.length?(t.forEach(function(e){app.$data.popkey.push(e)}),void app.$set("loading",!1)):void app.$set("popkeyIsDone",!0)});